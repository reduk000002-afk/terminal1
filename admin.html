<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å - –¢–æ—Ä–≥–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .login-box {
            max-width: 400px;
            margin: 100px auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 40px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .login-box h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #00b4d8;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #ade8f4;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #00b4d8;
            border-radius: 8px;
            color: white;
            font-size: 16px;
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            background: #0077b6;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #0096c7;
        }
        
        .error {
            color: #ff6b6b;
            text-align: center;
            margin-top: 15px;
            display: none;
        }
        
        /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
        .admin-panel {
            display: none;
        }
        
        .header {
            background: rgba(0, 119, 182, 0.2);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logout-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .card h3 {
            color: #90e0ef;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .card .value {
            font-size: 32px;
            font-weight: bold;
            color: #00b4d8;
        }
        
        .users-table {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .users-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .users-table th {
            background: rgba(0, 119, 182, 0.3);
            padding: 15px;
            text-align: left;
            color: #90e0ef;
        }
        
        .users-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .action-btn {
            padding: 6px 12px;
            margin: 2px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .edit-btn {
            background: #4ecdc4;
            color: white;
        }
        
        .delete-btn {
            background: #ff6b6b;
            color: white;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: #1a1a2e;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            border: 2px solid #00b4d8;
        }
        
        .modal h3 {
            color: #00b4d8;
            margin-bottom: 20px;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-success {
            background: #38b000;
        }
        
        .btn-cancel {
            background: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
        <div id="loginBox" class="login-box">
            <h2>üîê –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
            <div class="form-group">
                <label>–õ–æ–≥–∏–Ω –∞–¥–º–∏–Ω–∞:</label>
                <input type="text" id="adminLogin" placeholder="admin">
            </div>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∞:</label>
                <input type="password" id="adminPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>
            <button class="btn" onclick="login()">–í–æ–π—Ç–∏</button>
            <div id="loginError" class="error">‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å</div>
            
            <div style="margin-top: 20px; padding: 15px; background: rgba(255, 107, 107, 0.1); border-radius: 8px;">
                <p style="font-size: 14px; color: #ffd166;">
                    <strong>–í–∞–∂–Ω–æ:</strong> –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ admin-settings.json
                </p>
            </div>
        </div>
        
        <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
        <div id="adminPanel" class="admin-panel">
            <div class="header">
                <div>
                    <h1>üë®‚Äçüíº –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h1>
                    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</p>
                </div>
                <button class="logout-btn" onclick="logout()">üö™ –í—ã–π—Ç–∏</button>
            </div>
            
            <div class="stats-cards">
                <div class="card">
                    <h3>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                    <div class="value" id="totalUsers">0</div>
                </div>
                <div class="card">
                    <h3>–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</h3>
                    <div class="value" id="totalBalance">0 USDT</div>
                </div>
                <div class="card">
                    <h3>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–∞–Ω—Å</h3>
                    <div class="value" id="avgBalance">0 USDT</div>
                </div>
                <div class="card">
                    <h3>VIP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                    <div class="value" id="vipUsers">0</div>
                </div>
            </div>
            
            <div style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                <button class="btn" onclick="showAddUserModal()" style="width: auto; padding: 10px 20px;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
            </div>
            
            <div class="users-table">
                <table>
                    <thead>
                        <tr>
                            <th>–õ–æ–≥–∏–Ω</th>
                            <th>Email</th>
                            <th>–ë–∞–ª–∞–Ω—Å</th>
                            <th>–£—Ä–æ–≤–µ–Ω—å</th>
                            <th>–¢–∏–ø –≤—ã–≤–æ–¥–∞</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </tbody>
                </table>
            </div>
            
            <div style="background: rgba(0, 180, 216, 0.1); padding: 20px; border-radius: 10px;">
                <h3 style="color: #00b4d8; margin-bottom: 15px;">üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö:</h3>
                <p>1. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ –≤—ã—à–µ</p>
                <p>2. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è"</p>
                <p>3. –§–∞–π–ª users.json –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ GitHub</p>
                <button class="btn" onclick="saveChanges()" style="background: #38b000; margin-top: 15px;">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ GitHub
                </button>
                <div id="saveStatus" style="margin-top: 10px; font-size: 14px;"></div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
            <div class="form-group">
                <label>–õ–æ–≥–∏–Ω:</label>
                <input type="text" id="newUserLogin" placeholder="user123">
            </div>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å:</label>
                <input type="text" id="newUserPassword" placeholder="–ø–∞—Ä–æ–ª—å">
            </div>
            <div class="form-group">
                <label>Email:</label>
                <input type="email" id="newUserEmail" placeholder="user@example.com">
            </div>
            <div class="form-group">
                <label>–ë–∞–ª–∞–Ω—Å (USDT):</label>
                <input type="number" id="newUserBalance" value="100.00" step="0.01">
            </div>
            <div class="form-group">
                <label>–£—Ä–æ–≤–µ–Ω—å:</label>
                <select id="newUserLevel">
                    <option value="–°—Ç–∞–Ω–¥–∞—Ä—Ç">–°—Ç–∞–Ω–¥–∞—Ä—Ç</option>
                    <option value="VIP 1">VIP 1</option>
                    <option value="VIP 2">VIP 2</option>
                    <option value="VIP 3">VIP 3</option>
                </select>
            </div>
            <div class="form-group">
                <label>–¢–∏–ø –≤—ã–≤–æ–¥–∞:</label>
                <select id="newUserWithdrawType">
                    <option value="normal">Normal (1% –∫–æ–º–∏—Å—Å–∏—è)</option>
                    <option value="request">Request (–æ–¥–æ–±—Ä–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏)</option>
                    <option value="commission">Commission (40% –∫–æ–º–∏—Å—Å–∏—è)</option>
                </select>
            </div>
            <div class="btn-group">
                <button class="btn btn-success" onclick="addUser()">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button class="btn btn-cancel" onclick="hideAddUserModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div id="editUserModal" class="modal">
        <div class="modal-content">
            <h3>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
            <div class="form-group">
                <label>–õ–æ–≥–∏–Ω:</label>
                <input type="text" id="editUserLogin" readonly>
            </div>
            <div class="form-group">
                <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å):</label>
                <input type="text" id="editUserPassword" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å">
            </div>
            <div class="form-group">
                <label>Email:</label>
                <input type="email" id="editUserEmail">
            </div>
            <div class="form-group">
                <label>–ë–∞–ª–∞–Ω—Å (USDT):</label>
                <input type="number" id="editUserBalance" step="0.01">
            </div>
            <div class="form-group">
                <label>–£—Ä–æ–≤–µ–Ω—å:</label>
                <select id="editUserLevel">
                    <option value="–°—Ç–∞–Ω–¥–∞—Ä—Ç">–°—Ç–∞–Ω–¥–∞—Ä—Ç</option>
                    <option value="VIP 1">VIP 1</option>
                    <option value="VIP 2">VIP 2</option>
                    <option value="VIP 3">VIP 3</option>
                </select>
            </div>
            <div class="form-group">
                <label>–¢–∏–ø –≤—ã–≤–æ–¥–∞:</label>
                <select id="editUserWithdrawType">
                    <option value="normal">Normal</option>
                    <option value="request">Request</option>
                    <option value="commission">Commission</option>
                </select>
            </div>
            <div class="btn-group">
                <button class="btn btn-success" onclick="saveUserEdit()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="btn btn-cancel" onclick="hideEditUserModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script>
        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
        const GITHUB_USERNAME = 'reduk000002-afk';
        const GITHUB_REPO = 'terminal1';
        const BASE_URL = `https://raw.githubusercontent.com/${GITHUB_USERNAME}/${GITHUB_REPO}/main/`;
        
        let usersData = {};
        let currentEditUser = null;
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        async function init() {
            // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∞
            try {
                const response = await fetch(`${BASE_URL}admin-settings.json`);
                const settings = await response.json();
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ localStorage –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–Ω–∞
                localStorage.setItem('admin_username', settings.admin_username);
                localStorage.setItem('admin_password', settings.admin_password);
            } catch (error) {
                console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∞');
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞
        function login() {
            const username = document.getElementById('adminLogin').value;
            const password = document.getElementById('adminPassword').value;
            const errorElement = document.getElementById('loginError');
            
            const savedUsername = localStorage.getItem('admin_username') || 'admin';
            const savedPassword = localStorage.getItem('admin_password') || 'galardro123';
            
            if (username === savedUsername && password === savedPassword) {
                // –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
                document.getElementById('loginBox').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadUsersData();
            } else {
                errorElement.style.display = 'block';
                setTimeout(() => {
                    errorElement.style.display = 'none';
                }, 3000);
            }
        }
        
        // –í—ã—Ö–æ–¥
        function logout() {
            document.getElementById('loginBox').style.display = 'block';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('adminLogin').value = '';
            document.getElementById('adminPassword').value = '';
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        async function loadUsersData() {
            try {
                const response = await fetch(`${BASE_URL}users.json`);
                usersData = await response.json();
                renderUsersTable();
                updateStats();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', error);
                // –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π
                usersData = {};
                renderUsersTable();
            }
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function renderUsersTable() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            
            Object.entries(usersData).forEach(([username, user]) => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td><strong>${username}</strong></td>
                    <td>${user.email || `${username}@galardro.org`}</td>
                    <td>
                        <input type="number" 
                               value="${parseFloat(user.balance)}" 
                               step="0.01" 
                               style="width: 100px; padding: 5px;"
                               onchange="updateUserProperty('${username}', 'balance', this.value)">
                    </td>
                    <td>
                        <select onchange="updateUserProperty('${username}', 'level', this.value)" 
                                style="padding: 5px;">
                            <option value="–°—Ç–∞–Ω–¥–∞—Ä—Ç" ${user.level === '–°—Ç–∞–Ω–¥–∞—Ä—Ç' ? 'selected' : ''}>–°—Ç–∞–Ω–¥–∞—Ä—Ç</option>
                            <option value="VIP 1" ${user.level === 'VIP 1' ? 'selected' : ''}>VIP 1</option>
                            <option value="VIP 2" ${user.level === 'VIP 2' ? 'selected' : ''}>VIP 2</option>
                            <option value="VIP 3" ${user.level === 'VIP 3' ? 'selected' : ''}>VIP 3</option>
                        </select>
                    </td>
                    <td>
                        <select onchange="updateUserProperty('${username}', 'withdrawType', this.value)"
                                style="padding: 5px;">
                            <option value="normal" ${user.withdrawType === 'normal' ? 'selected' : ''}>Normal</option>
                            <option value="request" ${user.withdrawType === 'request' ? 'selected' : ''}>Request</option>
                            <option value="commission" ${user.withdrawType === 'commission' ? 'selected' : ''}>Commission</option>
                        </select>
                    </td>
                    <td>
                        <button class="action-btn edit-btn" onclick="showEditModal('${username}')">
                            ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å
                        </button>
                        <button class="action-btn delete-btn" onclick="deleteUser('${username}')">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function updateUserProperty(username, property, value) {
            if (usersData[username]) {
                if (property === 'balance') {
                    usersData[username][property] = parseFloat(value).toFixed(2);
                } else {
                    usersData[username][property] = value;
                }
                updateStats();
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            const users = Object.values(usersData);
            
            // –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            document.getElementById('totalUsers').textContent = users.length;
            
            // –û–±—â–∏–π –±–∞–ª–∞–Ω—Å
            const totalBalance = users.reduce((sum, user) => sum + parseFloat(user.balance), 0);
            document.getElementById('totalBalance').textContent = totalBalance.toFixed(2) + ' USDT';
            
            // –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–∞–Ω—Å
            const avgBalance = users.length > 0 ? totalBalance / users.length : 0;
            document.getElementById('avgBalance').textContent = avgBalance.toFixed(2) + ' USDT';
            
            // VIP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const vipUsers = users.filter(user => user.level.includes('VIP')).length;
            document.getElementById('vipUsers').textContent = vipUsers;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function showAddUserModal() {
            document.getElementById('addUserModal').style.display = 'flex';
        }
        
        function hideAddUserModal() {
            document.getElementById('addUserModal').style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function showEditModal(username) {
            currentEditUser = username;
            const user = usersData[username];
            
            document.getElementById('editUserLogin').value = username;
            document.getElementById('editUserEmail').value = user.email || '';
            document.getElementById('editUserBalance').value = parseFloat(user.balance);
            document.getElementById('editUserLevel').value = user.level;
            document.getElementById('editUserWithdrawType').value = user.withdrawType;
            
            document.getElementById('editUserModal').style.display = 'flex';
        }
        
        function hideEditUserModal() {
            document.getElementById('editUserModal').style.display = 'none';
            currentEditUser = null;
        }
        
        // –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function addUser() {
            const username = document.getElementById('newUserLogin').value.trim();
            const password = document.getElementById('newUserPassword').value.trim();
            const email = document.getElementById('newUserEmail').value.trim();
            const balance = parseFloat(document.getElementById('newUserBalance').value);
            const level = document.getElementById('newUserLevel').value;
            const withdrawType = document.getElementById('newUserWithdrawType').value;
            
            if (!username) {
                alert('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                return;
            }
            
            if (!password) {
                alert('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å');
                return;
            }
            
            if (usersData[username]) {
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                return;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            usersData[username] = {
                password: password,
                balance: balance.toFixed(2),
                level: level,
                withdrawType: withdrawType,
                email: email || `${username}@galardro.org`,
                created: new Date().toISOString()
            };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
            renderUsersTable();
            updateStats();
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É –∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
            document.getElementById('newUserLogin').value = '';
            document.getElementById('newUserPassword').value = '';
            document.getElementById('newUserEmail').value = '';
            document.getElementById('newUserBalance').value = '100.00';
            
            hideAddUserModal();
            showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!');
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
        function saveUserEdit() {
            if (!currentEditUser) return;
            
            const user = usersData[currentEditUser];
            const newPassword = document.getElementById('editUserPassword').value.trim();
            const email = document.getElementById('editUserEmail').value.trim();
            const balance = parseFloat(document.getElementById('editUserBalance').value);
            const level = document.getElementById('editUserLevel').value;
            const withdrawType = document.getElementById('editUserWithdrawType').value;
            
            if (newPassword) {
                user.password = newPassword;
            }
            
            user.email = email || `${currentEditUser}@galardro.org`;
            user.balance = balance.toFixed(2);
            user.level = level;
            user.withdrawType = withdrawType;
            
            renderUsersTable();
            updateStats();
            hideEditUserModal();
            showNotification('–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }
        
        // –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function deleteUser(username) {
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${username}?`)) return;
            
            delete usersData[username];
            renderUsersTable();
            updateStats();
            showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω!');
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ GitHub
        async function saveChanges() {
            const statusElement = document.getElementById('saveStatus');
            statusElement.innerHTML = '‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
            statusElement.style.color = '#ffd166';
            
            try {
                // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∫–æ–¥ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ GitHub
                // –ü–æ–∫–∞ —á—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –¥–µ–º–æ
                localStorage.setItem('users_backup', JSON.stringify(usersData));
                
                statusElement.innerHTML = '‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ';
                statusElement.style.color = '#38b000';
                
                // –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ GitHub
                setTimeout(() => {
                    statusElement.innerHTML = `
                        <strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ GitHub:</strong><br>
                        1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª users.json –≤ –≤–∞—à–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏<br>
                        2. –ó–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–∞ —ç—Ç–æ—Ç JSON:<br>
                        <textarea style="width:100%; height:100px; margin-top:10px;">${JSON.stringify(usersData, null, 2)}</textarea><br>
                        3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –∏ –∑–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
                    `;
                }, 2000);
                
            } catch (error) {
                statusElement.innerHTML = '‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + error.message;
                statusElement.style.color = '#ff6b6b';
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message) {
            alert(message); // –ü—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = init;
    </script>
</body>
</html>
