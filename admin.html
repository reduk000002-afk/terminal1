<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial; }
        body { background: #0f172a; color: white; min-height: 100vh; }
        
        .login-page { display: flex; justify-content: center; align-items: center; height: 100vh; }
        .login-box { background: #1e293b; padding: 40px; border-radius: 15px; width: 100%; max-width: 400px; text-align: center; }
        .login-input { width: 100%; padding: 15px; margin: 20px 0; background: #334155; border: 2px solid #3b82f6; border-radius: 8px; color: white; }
        .login-btn { width: 100%; padding: 15px; background: #3b82f6; color: white; border: none; border-radius: 8px; font-size: 18px; cursor: pointer; }
        
        .admin-page { display: none; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .header { background: rgba(37,99,235,0.2); padding: 25px; border-radius: 15px; margin-bottom: 30px; }
        
        .editable-table { background: #1e293b; border-radius: 15px; padding: 20px; margin-bottom: 30px; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #334155; padding: 15px; text-align: left; color: #93c5fd; }
        td { padding: 15px; border-bottom: 1px solid #334155; }
        .edit-input { width: 100%; padding: 8px; background: #475569; border: 1px solid #3b82f6; border-radius: 5px; color: white; }
        
        .auto-save-btn { width: 100%; padding: 18px; background: #16a34a; color: white; border: none; border-radius: 10px; font-size: 18px; cursor: pointer; margin-top: 20px; }
        
        .status { padding: 15px; border-radius: 10px; margin: 20px 0; text-align: center; display: none; }
        .success { background: rgba(34,197,94,0.2); color: #86efac; border: 2px solid #16a34a; }
        .error { background: rgba(239,68,68,0.2); color: #fca5a5; border: 2px solid #dc2626; }
    </style>
</head>
<body>
    <!-- –õ–æ–≥–∏–Ω -->
    <div id="loginPage" class="login-page">
        <div class="login-box">
            <h2>üîê –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
            <p style="color: #94a3b8;">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</p>
            
            <input type="password" id="passwordInput" class="login-input" placeholder="–ü–∞—Ä–æ–ª—å (admin123)">
            <button class="login-btn" onclick="login()">–í–æ–π—Ç–∏</button>
            
            <div id="loginError" style="color:#f87171; margin-top:15px; display:none;">
                ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å
            </div>
        </div>
    </div>
    
    <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
    <div id="adminPage" class="admin-page">
        <div class="header">
            <div>
                <h1>üëë –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h1>
                <p style="color: #94a3b8;">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ GitHub</p>
            </div>
            <button onclick="logout()" style="background:#dc2626; color:white; border:none; padding:12px 25px; border-radius:8px; cursor:pointer;">
                üö™ –í—ã–π—Ç–∏
            </button>
        </div>
        
        <div class="editable-table">
            <h3 style="margin-bottom: 20px; color: #60a5fa;">üë• –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
            
            <div style="margin-bottom: 20px;">
                <button onclick="addUser()" style="background:#10b981; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; margin-right:10px;">
                    ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                </button>
                <button onclick="saveChanges()" style="background:#3b82f6; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer;">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                </button>
                <span id="autoSaveStatus" style="margin-left: 15px; color: #94a3b8;"></span>
            </div>
            
            <table id="usersTable">
                <thead>
                    <tr>
                        <th>–õ–æ–≥–∏–Ω</th>
                        <th>Email</th>
                        <th>–ë–∞–ª–∞–Ω—Å (USDT)</th>
                        <th>–£—Ä–æ–≤–µ–Ω—å</th>
                        <th>–¢–∏–ø –≤—ã–≤–æ–¥–∞</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="usersTableBody">
                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </tbody>
            </table>
        </div>
        
        <button class="auto-save-btn" onclick="saveToGitHub()">
            üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ GitHub
        </button>
        
        <div id="statusMessage" class="status"></div>
        
        <div style="margin-top: 30px; padding: 20px; background: rgba(59,130,246,0.1); border-radius: 15px;">
            <h3 style="color: #60a5fa;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                <div>
                    <div style="color: #94a3b8;">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    <div style="font-size: 32px; font-weight: bold; color: #60a5fa;" id="totalUsers">0</div>
                </div>
                <div>
                    <div style="color: #94a3b8;">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</div>
                    <div style="font-size: 32px; font-weight: bold; color: #60a5fa;" id="totalBalance">0 USDT</div>
                </div>
                <div>
                    <div style="color: #94a3b8;">–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</div>
                    <div style="font-size: 20px; color: #86efac;" id="lastSave">‚Äî</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ============
        const ADMIN_PASSWORD = 'admin123';
        const GITHUB_USERNAME = 'reduk000002-afk';
        const GITHUB_REPO = 'terminal1';
        const BASE_URL = `https://raw.githubusercontent.com/${GITHUB_USERNAME}/${GITHUB_REPO}/main/`;
        
        // ============ –í–ê–®–ò –°–ï–ö–†–ï–¢–ù–´–ï –ö–õ–Æ–ß–ò ============
        // 1. –°–æ–∑–¥–∞–π—Ç–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ Secret: ADMIN_WEBHOOK_SECRET
        // 2. –°–æ–∑–¥–∞–π—Ç–µ Personal Access Token —Å –ø—Ä–∞–≤–∞–º–∏ repo
        const GITHUB_TOKEN = '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'; // ‚Üê –í–°–¢–ê–í–¨–¢–ï –í–ê–® –¢–û–ö–ï–ù
        const WEBHOOK_SECRET = 'galardro_admin_2024_secret_key_123456'; // ‚Üê –î–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Å–µ–∫—Ä–µ—Ç–æ–º –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
        
        let usersData = {};
        let isAutoSaveEnabled = true;
        let autoSaveTimer = null;
        
        // ============ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ============
        window.onload = function() {
            const isLoggedIn = localStorage.getItem('admin_logged_in') === 'true';
            if (isLoggedIn) {
                showAdminPage();
                loadUsers();
            }
            
            // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                if (isAutoSaveEnabled && document.getElementById('adminPage').style.display !== 'none') {
                    autoSaveChanges();
                }
            }, 30000);
        };
        
        // ============ –í–•–û–î ============
        function login() {
            const password = document.getElementById('passwordInput').value;
            const errorElement = document.getElementById('loginError');
            
            if (password === ADMIN_PASSWORD) {
                localStorage.setItem('admin_logged_in', 'true');
                showAdminPage();
                loadUsers();
            } else {
                errorElement.style.display = 'block';
                setTimeout(() => errorElement.style.display = 'none', 3000);
            }
        }
        
        function showAdminPage() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('adminPage').style.display = 'block';
        }
        
        function logout() {
            if (confirm('–í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏?')) {
                localStorage.removeItem('admin_logged_in');
                location.reload();
            }
        }
        
        // ============ –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• ============
        async function loadUsers() {
            try {
                showStatus('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...', 'info');
                
                const response = await fetch(`${BASE_URL}users.json?t=${Date.now()}`);
                
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ ${response.status}: ${response.statusText}`);
                }
                
                usersData = await response.json();
                renderUsersTable();
                updateStats();
                
                showStatus('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 'success');
                setTimeout(() => hideStatus(), 2000);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                showStatus(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}`, 'error');
                
                // –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç
                usersData = {
                    "admin_demo": {
                        "password": "demo123",
                        "balance": "1000.00",
                        "level": "VIP 1",
                        "withdrawType": "normal",
                        "email": "demo@galardro.org"
                    }
                };
                renderUsersTable();
                updateStats();
            }
        }
        
        // ============ –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –¢–ê–ë–õ–ò–¶–´ ============
        function renderUsersTable() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            
            for (const [username, user] of Object.entries(usersData)) {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>
                        <input type="text" 
                               class="edit-input" 
                               value="${username}" 
                               onchange="updateUsername('${username}', this.value)"
                               style="font-weight: bold;">
                    </td>
                    <td>
                        <input type="email" 
                               class="edit-input" 
                               value="${user.email || `${username}@galardro.org`}"
                               onchange="updateUserField('${username}', 'email', this.value)">
                    </td>
                    <td>
                        <input type="number" 
                               class="edit-input" 
                               value="${parseFloat(user.balance)}" 
                               step="0.01"
                               onchange="updateUserField('${username}', 'balance', this.value)">
                    </td>
                    <td>
                        <select class="edit-input" onchange="updateUserField('${username}', 'level', this.value)">
                            <option value="–°—Ç–∞–Ω–¥–∞—Ä—Ç" ${user.level === '–°—Ç–∞–Ω–¥–∞—Ä—Ç' ? 'selected' : ''}>–°—Ç–∞–Ω–¥–∞—Ä—Ç</option>
                            <option value="VIP 1" ${user.level === 'VIP 1' ? 'selected' : ''}>VIP 1</option>
                            <option value="VIP 2" ${user.level === 'VIP 2' ? 'selected' : ''}>VIP 2</option>
                            <option value="VIP 3" ${user.level === 'VIP 3' ? 'selected' : ''}>VIP 3</option>
                        </select>
                    </td>
                    <td>
                        <select class="edit-input" onchange="updateUserField('${username}', 'withdrawType', this.value)">
                            <option value="normal" ${user.withdrawType === 'normal' ? 'selected' : ''}>Normal</option>
                            <option value="request" ${user.withdrawType === 'request' ? 'selected' : ''}>Request</option>
                            <option value="commission" ${user.withdrawType === 'commission' ? 'selected' : ''}>Commission</option>
                        </select>
                    </td>
                    <td>
                        <button onclick="deleteUser('${username}')" 
                                style="background:#dc2626; color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer;">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            }
        }
        
        // ============ –û–ë–ù–û–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–• ============
        function updateUsername(oldUsername, newUsername) {
            if (!newUsername.trim()) {
                alert('–õ–æ–≥–∏–Ω –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º');
                return;
            }
            
            if (newUsername !== oldUsername) {
                if (usersData[newUsername]) {
                    alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                    return;
                }
                
                usersData[newUsername] = usersData[oldUsername];
                delete usersData[oldUsername];
                
                renderUsersTable();
                updateStats();
                triggerAutoSave();
            }
        }
        
        function updateUserField(username, field, value) {
            if (!usersData[username]) return;
            
            if (field === 'balance') {
                usersData[username][field] = parseFloat(value).toFixed(2);
            } else {
                usersData[username][field] = value;
            }
            
            updateStats();
            triggerAutoSave();
        }
        
        function deleteUser(username) {
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è "${username}"?`)) return;
            
            delete usersData[username];
            renderUsersTable();
            updateStats();
            triggerAutoSave();
            
            showStatus(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} —É–¥–∞–ª–µ–Ω`, 'success');
        }
        
        function addUser() {
            const newUsername = prompt('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:');
            if (!newUsername) return;
            
            if (usersData[newUsername]) {
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                return;
            }
            
            usersData[newUsername] = {
                password: 'default123',
                balance: '100.00',
                level: '–°—Ç–∞–Ω–¥–∞—Ä—Ç',
                withdrawType: 'normal',
                email: `${newUsername}@galardro.org`,
                created: new Date().toISOString()
            };
            
            renderUsersTable();
            updateStats();
            triggerAutoSave();
            
            showStatus(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${newUsername} –¥–æ–±–∞–≤–ª–µ–Ω`, 'success');
        }
        
        // ============ –ê–í–¢–û–°–û–•–†–ê–ù–ï–ù–ò–ï ============
        function triggerAutoSave() {
            if (!isAutoSaveEnabled) return;
            
            const statusElement = document.getElementById('autoSaveStatus');
            statusElement.textContent = '‚è≥ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ';
            statusElement.style.color = '#f59e0b';
            
            // –û—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ GitHub –Ω–∞ 2 —Å–µ–∫—É–Ω–¥—ã
            clearTimeout(autoSaveTimer);
            autoSaveTimer = setTimeout(() => {
                saveToGitHub();
            }, 2000);
        }
        
        function autoSaveChanges() {
            if (Object.keys(usersData).length > 0) {
                saveToGitHub();
            }
        }
        
        // ============ –°–û–•–†–ê–ù–ï–ù–ò–ï –ù–ê GITHUB ============
        async function saveToGitHub() {
            showStatus('‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ GitHub...', 'info');
            
            // –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ GitHub API (–ø—Ä—è–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞)
            try {
                await saveViaGitHubAPI();
                return;
            } catch (apiError) {
                console.log('GitHub API –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –ø—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ Actions...');
            }
            
            // –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ GitHub Actions
            try {
                await saveViaGitHubActions();
                return;
            } catch (actionsError) {
                console.log('GitHub Actions –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏...', actionsError);
            }
            
            // –°–ø–æ—Å–æ–± 3: –†–µ–∑–µ—Ä–≤–Ω—ã–π - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º JSON –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            showManualSaveOption();
        }
        
        // –°–ø–æ—Å–æ–± 1: –ü—Ä—è–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ GitHub API
        async function saveViaGitHubAPI() {
            if (!GITHUB_TOKEN || GITHUB_TOKEN.includes('–≤–∞—à_')) {
                throw new Error('–¢–æ–∫–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω');
            }
            
            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π sha —Ñ–∞–π–ª–∞
            const getResponse = await fetch(`${BASE_URL}users.json`);
            let sha = '';
            
            if (getResponse.ok) {
                const data = await getResponse.json();
                sha = data.sha || '';
            }
            
            // –ö–æ–¥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
            const content = btoa(unescape(encodeURIComponent(JSON.stringify(usersData, null, 2))));
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            const response = await fetch(`https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/contents/users.json`, {
                method: 'PUT',
                headers: {
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${GITHUB_TOKEN}`
                },
                body: JSON.stringify({
                    message: `Admin: Update users at ${new Date().toLocaleString()}`,
                    content: content,
                    sha: sha || undefined
                })
            });
            
            const result = await response.json();
            
            if (response.ok) {
                document.getElementById('lastSave').textContent = new Date().toLocaleTimeString('ru-RU');
                showStatus('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞ GitHub!', 'success');
                return result;
            } else {
                throw new Error(result.message || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
            }
        }
        
        // –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ GitHub Actions (–≤–µ–±—Ö—É–∫)
        async function saveViaGitHubActions() {
            const response = await fetch(`https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/dispatches`, {
                method: 'POST',
                headers: {
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${GITHUB_TOKEN}`
                },
                body: JSON.stringify({
                    event_type: 'update_users',
                    client_payload: {
                        secret: WEBHOOK_SECRET,
                        users_data: JSON.stringify(usersData, null, 2),
                        timestamp: new Date().toISOString()
                    }
                })
            });
            
            if (response.ok) {
                document.getElementById('lastSave').textContent = new Date().toLocaleTimeString('ru-RU');
                showStatus('‚úÖ –ó–∞–ø—Ä–æ—Å –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ GitHub Actions', 'success');
            } else {
                throw new Error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–µ–±—Ö—É–∫–∞');
            }
        }
        
        // –°–ø–æ—Å–æ–± 3: –†—É—á–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        function showManualSaveOption() {
            const jsonData = JSON.stringify(usersData, null, 2);
            const statusElement = document.getElementById('statusMessage');
            
            statusElement.innerHTML = `
                <div style="text-align: left;">
                    <strong>üìã –°–∫–æ–ø–∏—Ä—É–π—Ç–µ JSON –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:</strong>
                    <textarea 
                        style="width:100%; height:200px; margin-top:10px; padding:15px; 
                               background:#1e293b; color:white; border:2px solid #3b82f6;
                               border-radius:8px; font-family: monospace;"
                        onclick="this.select()"
                        readonly>${jsonData}</textarea>
                    
                    <div style="margin-top: 15px;">
                        <a href="https://github.com/${GITHUB_USERNAME}/${GITHUB_REPO}/edit/main/users.json" 
                           target="_blank"
                           style="display: inline-block; background: #3b82f6; color: white; 
                                  padding: 12px 25px; border-radius: 8px; text-decoration: none; font-weight: bold;">
                           ‚úèÔ∏è –û—Ç–∫—Ä—ã—Ç—å users.json –Ω–∞ GitHub
                        </a>
                        
                        <button onclick="copyToClipboard()" 
                                style="margin-left: 15px; background: #10b981; color: white; 
                                       padding: 12px 25px; border-radius: 8px; border: none; cursor: pointer;">
                            üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON
                        </button>
                    </div>
                </div>
            `;
            statusElement.className = 'status';
            statusElement.style.display = 'block';
        }
        
        function copyToClipboard() {
            const textarea = document.querySelector('#statusMessage textarea');
            textarea.select();
            document.execCommand('copy');
            
            const statusElement = document.getElementById('statusMessage');
            const originalHTML = statusElement.innerHTML;
            
            statusElement.innerHTML = '<div style="color: #86efac;">‚úÖ JSON —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!</div>';
            
            setTimeout(() => {
                statusElement.innerHTML = originalHTML;
            }, 2000);
        }
        
        // ============ –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ============
        function updateStats() {
            const users = Object.values(usersData);
            
            document.getElementById('totalUsers').textContent = users.length;
            
            const totalBalance = users.reduce((sum, user) => sum + parseFloat(user.balance || 0), 0);
            document.getElementById('totalBalance').textContent = totalBalance.toFixed(2) + ' USDT';
        }
        
        function showStatus(message, type = 'info') {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = `status ${type}`;
            statusElement.style.display = 'block';
            
            if (type === 'info') {
                setTimeout(hideStatus, 3000);
            }
        }
        
        function hideStatus() {
            document.getElementById('statusMessage').style.display = 'none';
        }
        
        function saveChanges() {
            saveToGitHub();
        }
    </script>
</body>
</html>
